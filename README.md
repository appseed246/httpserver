# CSZAP4課題 - system call & socket programming

## 課題内容
C言語 + system call でHTTP Serverを作ってみよう

`GET /calc?query=2+10 HTTP/1.1` というHTTPリクエストに対して、以下のレスポンスを返すプログラムを作成する
```
HTTP/1.1 200 OK
Content-Length: 2

12
```

## 仕様
- サーバー
  - 共通
    - HTTP/1.1のみ対応
    - 正しいフォーマットに従ったHTTPリクエストのみ送信される想定でリクエストを処理する
    - 指定可能なリクエストパラメータは10個まで処理可能。11個以降のパラメータは無視される。
  - `/calc`
    - 同じkeyのパラメータが複数送られてきた場合、先頭のパラメータのみ有効として処理する
      - 例: `/calc?query=2+10&query=20+10`の場合、`query=2+10`のみ読み込み、`12`を返却する
    - queryパラメータで指定された文字列が数式のフォーマットでなく、計算が不可能である場合、HTTPステータス400で
      - レスポンスボディは空文字
    - queryパラメータに数値(正 or 負値)のみ指定した場合、その値をそのまま返却する
      - 例: `/calc?query=10`の場合、`10`
      - 例: `/calc?query=-2`の場合、`-2`
    - 整数の足し算(`+`)と引き算(`-`)のみ対応。掛け算、割り算、カッコは使用不可。
- クライアント
  - xxx

## TODO

### サーバー
- [x] HTTPリクエスト情報をパースする
  - パス
  - クエリパラメータ
- [x] クエリパラメータの内容を元に計算を行う関数を実装する
- [x] 計算結果をHTTPレスポンスで返却する
- [ ] システムコールのエラーハンドリング

### クライアント
- [ ] TODO

## 発展課題
- [ ] IPv4+v6 両対応
- CPU 性能を最大限活用できるようにする
  - [ ] non-blocking 化
  - [ ] マルチスレッド化
- [ ] 通信タイムアウトの設定
- [ ] signal を受け取ったら、全コネクションが正常終了して終了
- [ ] SSL

## 開発環境
Ubuntu-24.04.3 x86_64

## 実行方法
サーバープログラム
```
gcc server.c http_server.c -o server && ./server
```

クライアントプログラム
```
gcc client.c -o client && ./client
```